<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auth | MindCare</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="auth-container">
    <h2 id="form-title">Login</h2>
    <form id="auth-form">
      <input type="text" id="username" placeholder="Username" required>
      <input type="password" id="password" placeholder="Password" required>
      <span id="toggle-password">Show</span>
      <button type="submit">Login</button>
      <p id="toggle-form">Don't have an account? <a href="#">Sign up</a></p>
    </form>
  </div>

  <script>
    const toggleForm = document.getElementById('toggle-form');
    const formTitle = document.getElementById('form-title');
    const authForm = document.getElementById('auth-form');
    const passwordInput = document.getElementById('password');
    const togglePassword = document.getElementById('toggle-password');
    let isLogin = true;

    toggleForm.addEventListener('click', () => {
      isLogin = !isLogin;
      formTitle.textContent = isLogin ? 'Login' : 'Signup';
      authForm.querySelector('button').textContent = isLogin ? 'Login' : 'Signup';
      toggleForm.innerHTML = isLogin
        ? "Don't have an account? <a href='#'>Sign up</a>"
        : "Already have an account? <a href='#'>Login</a>";
    });

    togglePassword.addEventListener('click', () => {
      if (passwordInput.type === "password") {
        passwordInput.type = "text";
        togglePassword.textContent = "Hide";
      } else {
        passwordInput.type = "password";
        togglePassword.textContent = "Show";
      }
    });

    authForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      const res = await fetch(`/api/${isLogin ? 'login' : 'signup'}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username, password }),
      });

      const data = await res.json();
      if (data.success) {
        if (data.success) {
  window.location.href = '/index.html';
}

        window.location.href = '/index.html';
      } else {
        alert(data.message);
      }
    });
  </script>
</body>
</html>
